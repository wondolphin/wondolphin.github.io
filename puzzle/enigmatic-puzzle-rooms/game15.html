<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>２スウ１２ヤク</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* 落ち着いたカジノのような配色 */
            --bg-color: #2e7d32; /* 深いグリーン (カジノテーブル) */
            --container-bg: #4caf50; /* 少し明るいグリーン */
            --main-text-color: #eceff1; /* 非常に淡いグレー */
            --border-color: #66bb6a; /* 明るいグリーン */
            --accent-color-dark: #b71c1c; /* 深い赤 (アクセント) */
            --card-color-bg: #f5f5f5; /* カードの白 */
            --card-color-border: #9e9e9e; /* カードのグレー枠 */
            --lamp-off-bg: #616161; /* 暗いグレー */
            --lamp-off-border: #9e9e9e;
            --lamp-lit-color: #ffd700; /* ゴールド */
            --lamp-lit-shadow: 0 0 25px var(--lamp-lit-color), inset 0 0 10px rgba(255, 255, 255, 0.7);
            --title-frame-color: #45b26b; /* #a98e72; から変更 */

            /* サイズ設定 (レスポンシブなvmin単位に変更) */
            --card-size: 8vmin;
            --lamp-size: 6.5vmin;
            --gap-size: 1.8vmin;
            --border-radius: 1.5vmin;
            --small-border-radius: 1vmin;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color);
            color: var(--main-text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh; /* min-heightから変更 */
            margin: 0;
            user-select: none;
            overflow: hidden;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB2aWV3Qm94PSIwIDAgMTIwIDEyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0aCBpZD0icGF0dGVybi1kb3QiIGQ9Ik02MCwwYTUsNSAwIDEwMCAxMDAsNSAwIDEtMCA1LTV6Ii8+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIiBwYXR0ZXJuVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSIwIiB5PSIwIj48dXNlIHhsaW5rOmhyZWY9IiNwYXR0ZXJuLWRvdCIgeD0iMCIgeT0iMCIgZmlsbD0iIzQwYTBiYSIvPjx1c2UgeGxpbms6aHJlZj0iI3BhdHRlcm4tZG90IiB4PSI2MCIgeT0iMCIgZmlsbD0iIzQwYTBiYSIvPjx1c2UgeGxpbms6aHJlZj0iI3BhdHRlcm4tZG90IiB4PSIwIiB5PSI2MCIgZmlsbD0iIzQwYTBiYSIvPjx1c2UgeGxpbms6aHJlZj0iI3BhdHRlcm4tZG90IiB4PSI2MCIgeT0iNjAiIGZpbGw9IiMjNDBhMGJhIi8+PC9wYXR0ZXJuPjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2dyaWQpIi8+PC9zdmc+');
            background-size: 60px 60px;
            background-blend-mode: multiply;
            /* transformプロパティを削除 */
        }

        #game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2.5vmin; /* ギャップをvminに */
            padding: 3.5vmin; /* パディングをvminに */
            background-color: var(--container-bg);
            border-radius: var(--border-radius);
            box-shadow: 0 1.5vmin 4vmin rgba(0,0,0,0.3);
            width: 95vmin;  /* 幅をvminに */
            max-width: 800px; /* PCなど大画面での最大幅を指定 */
            border: 0.8vmin solid var(--title-frame-color);
        }

        h1 {
            font-family: 'Playfair Display', serif;
            margin: 0 0 1.5vmin 0; /* マージンをvminに */
            font-size: 5vmin; /* フォントサイズをvminに */
            color: #bbee88;
            letter-spacing: 0.2vmin; /* 文字間隔をvminに */
            font-weight: 700;
            text-shadow: 0 0.4vmin 1vmin rgba(0,0,0,0.4);
        }

        #lamp-grid {
            display: grid;
            grid-template-columns: repeat(6, var(--lamp-size));
            grid-template-rows: repeat(2, var(--lamp-size));
            gap: var(--gap-size);
            padding: 1.8vmin; /* パディングをvminに */
            background-color: #388e3c;
            border-radius: var(--border-radius);
            box-shadow: inset 0 0.4vmin 1vmin rgba(0,0,0,0.2);
            border: 0.3vmin solid #81c784;
        }

        .lamp {
            width: var(--lamp-size);
            height: var(--lamp-size);
            background-color: var(--lamp-off-bg);
            border-radius: 50%;
            transition: background-color 0.4s ease-out, box-shadow 0.4s ease-out, border-color 0.4s ease-out;
            border: 0.4vmin solid var(--lamp-off-border);
            box-shadow: inset 0 0.3vmin 0.5vmin rgba(0,0,0,0.15);
        }

        .lamp.lit {
            background-color: var(--lamp-lit-color);
            box-shadow: var(--lamp-lit-shadow);
            border-color: #ffc107;
        }

        #set-areas-container {
            display: flex;
            gap: var(--gap-size);
            margin-top: 1vmin; /* マージンをvminに */
        }

        .set-area {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1vmin; /* ギャップをvminに */
            padding: 1vmin 1.2vmin; /* パディングをvminに */
            border-radius: var(--small-border-radius);
            min-width: calc((var(--card-size) * 3) + (1vmin * 2) + (2.5vmin));
            height: calc(var(--card-size) + 2vmin); /* 高さをvmin基準に */
            background-color: #43a047;
            box-shadow: inset 0 0.2vmin 0.4vmin rgba(0,0,0,0.2);
        }
        
        .card-placeholder {
            width: var(--card-size);
            height: var(--card-size);
            border: 0.3vmin dashed rgba(255, 255, 255, 0.4);
            border-radius: var(--small-border-radius);
            box-sizing: border-box;
        }

        .card {
            width: var(--card-size);
            height: var(--card-size);
            background-color: var(--card-color-bg);
            border: 0.3vmin solid var(--card-color-border);
            border-radius: var(--small-border-radius);
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3.5vmin; /* フォントサイズをvminに */
            font-weight: 700;
            color: var(--accent-color-dark);
            cursor: pointer;
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out, background-color 0.2s ease-out;
            box-shadow: 0 0.4vmin 1vmin rgba(0,0,0,0.2);
        }

        .card:hover {
            transform: translateY(-0.6vmin); /* 移動量をvminに */
            box-shadow: 0 1.2vmin 2.5vmin rgba(0,0,0,0.3);
            background-color: #ffee58;
            border-color: #ffc107;
        }

        #standby-area {
            display: flex;
            gap: var(--gap-size);
            padding: 2.5vmin; /* パディングをvminに */
            border: 0.4vmin solid #aed581;
            border-radius: var(--border-radius);
            min-height: calc(var(--card-size) + 5vmin); /* 高さをvmin基準に */
            width: 90%; /* 親要素に対する割合に変更 */
            justify-content: center;
            align-content: center;
            flex-wrap: wrap;
            background-color: #4caf50;
            box-shadow: inset 0 0.3vmin 0.6vmin rgba(0,0,0,0.15);
        }
        
        #clear-message {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            color: var(--lamp-lit-color);
            font-size: 12vmin; /* フォントサイズをvminに */
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            display: none;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            animation: fadeIn 0.6s ease-out;
            letter-spacing: 1vmin; /* 文字間隔をvminに */
            text-shadow: 0 0.6vmin 1.8vmin rgba(255,215,0,0.6);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

    </style>
</head>
<body>

    <div id="game-container">
        <h1>２スウ１２ヤク</h1>
        <div id="lamp-grid"></div>
        <div id="set-areas-container">
            <div class="set-area" data-area-id="0"></div>
            <div class="set-area" data-area-id="1"></div>
        </div>
        <div id="standby-area"></div>
    </div>

    <div id="clear-message">CLEAR!</div>

    <script>
        const lampGrid = document.getElementById('lamp-grid');
        const setAreas = document.querySelectorAll('.set-area');
        const standbyArea = document.getElementById('standby-area');
        const clearMessage = document.getElementById('clear-message');

        const initialCards = [0, 1, 2, 3, 4, 5, 6];
        let standbyCards = [...initialCards];

        function createCard(number) {
            const card = document.createElement('div');
            card.className = 'card';
            card.textContent = number;
            card.dataset.value = number;
            card.addEventListener('click', moveCardToStandbyArea);
            return card;
        }
        
        function createPlaceholder() {
            const placeholder = document.createElement('div');
            placeholder.className = 'card-placeholder';
            return placeholder;
        }

        function renderStandbyCards() {
            standbyArea.innerHTML = '';
            standbyCards.sort((a, b) => a - b);
            standbyCards.forEach(num => {
                const card = createCard(num);
                card.removeEventListener('click', moveCardToStandbyArea); // remove listener for standby
                card.addEventListener('click', moveCardToSetArea);
                standbyArea.appendChild(card);
            });
        }
        
        function moveCardToSetArea(event) {
            const value = parseInt(event.target.dataset.value, 10);
            const targetPlaceholder = document.querySelector('.card-placeholder');

            if (targetPlaceholder) {
                standbyCards = standbyCards.filter(n => n !== value);
                renderStandbyCards();

                const newCard = createCard(value);
                targetPlaceholder.parentElement.replaceChild(newCard, targetPlaceholder);
                
                updateGame();
            }
        }

        function moveCardToStandbyArea(event) {
            const card = event.target;
            const value = parseInt(card.dataset.value, 10);
            
            standbyCards.push(value);
            renderStandbyCards();

            const placeholder = createPlaceholder();
            card.parentElement.replaceChild(placeholder, card);
            
            updateGame();
        }

        let clearTimeoutId = null;

        function updateGame() {
            const numbers = Array.from(setAreas).map(area => {
                if (area.querySelector('.card-placeholder')) {
                    return null;
                }
                
                let numStr = '';
                for (const card of area.children) {
                    numStr += card.textContent;
                }
                return parseInt(numStr, 10);
            });

            let litCount = 0;
            for (let i = 1; i <= 12; i++) {
                const lamp = document.getElementById(`lamp-${i}`);
                let isLit = false;
                numbers.forEach(num => {
                    if (num !== null && num > 0 && num % i === 0) {
                        isLit = true;
                    }
                });

                if (isLit) {
                    lamp.classList.add('lit');
                    litCount++;
                } else {
                    lamp.classList.remove('lit');
                }
            }
            
            if (litCount === 12) {
                window.parent.postMessage({ event: 'gameCleared', gameName: 'game15' }, '*');
                if (!clearMessage.style.display || clearMessage.style.display === 'none') {
                     clearTimeoutId = setTimeout(() => {
                        clearMessage.style.display = 'flex';
                    }, 500);
                }
            } else {
                if (clearTimeoutId) {
                    clearTimeout(clearTimeoutId);
                    clearTimeoutId = null;
                }
                clearMessage.style.display = 'none';
            }
        }

        function init() {
            for (let i = 1; i <= 12; i++) {
                const lamp = document.createElement('div');
                lamp.className = 'lamp';
                lamp.id = `lamp-${i}`;
                lampGrid.appendChild(lamp);
            }
            
            setAreas.forEach(area => {
                for (let i = 0; i < 3; i++) {
                    area.appendChild(createPlaceholder());
                }
            });

            renderStandbyCards();
            
            clearMessage.addEventListener('click', () => {
                clearMessage.style.display = 'none';
            });
        }
        
        init();
    </script>

</body>
</html>




